import{a as at}from"./chunk-DSHM7QFZ.js";import{b as lt}from"./chunk-YMO3DXVO.js";import{a as rt}from"./chunk-3TQ4UNVT.js";import{b as T,g as N,h as q,i as j,j as U,k as R}from"./chunk-FPQQBUCR.js";import{$a as et,Ba as g,Ca as G,Da as H,Ia as V,Ka as $,La as z,Oa as K,Qa as Y,Sa as J,Ta as Q,Ua as W,Wa as X,Za as Z,_a as tt,ab as it,bb as nt,cb as ot,ja as P,ka as w,oa as D,ua as k,wa as O,xa as A,za as B}from"./chunk-PVO7PMX5.js";import{l as I,m as L,t as F}from"./chunk-ZJDWWCZS.js";import{Bb as e,Cb as t,Db as y,Kb as _,Pb as h,Va as a,Wa as f,Xb as r,Yb as E,Zb as C,da as S,dc as x,ha as b,qb as c,sb as m}from"./chunk-HGSCEON2.js";function mt(i,s){if(i&1&&(e(0,"mat-option",18),r(1),t()),i&2){let n=s.$implicit;h("value",n.DISTRICT_ID),a(),C("",n.DISTRICT_NAME," ")}}function st(i,s){i&1&&(e(0,"mat-error"),r(1," District is required "),t())}function dt(i,s){if(i&1&&(e(0,"mat-option",18),r(1),t()),i&2){let n=s.$implicit;h("value",n.TALUKA_ID),a(),C("",n.TALUKA_NAME," ")}}function pt(i,s){i&1&&(e(0,"mat-error"),r(1," District is required "),t())}function ct(i,s){if(i&1&&(e(0,"mat-option",18),r(1),t()),i&2){let n=s.$implicit;h("value",n.PANCHAYAT_ID),a(),C("",n.PANCHAYAT_NAME," ")}}function ut(i,s){i&1&&(e(0,"mat-error"),r(1," District is required "),t())}function ft(i,s){i&1&&(e(0,"mat-error"),r(1," Username is required "),t())}function gt(i,s){i&1&&(e(0,"mat-error"),r(1," Password is required "),t())}var Bt=(()=>{class i{constructor(n,l,o,d,p){this.fb=n,this.spinner=l,this.api=o,this.util=d,this.router=p,this.hidePassword=!0,this.districtList=[],this.talukaList=[],this.panchayatList=[],this.dialog=S(D),this.loginForm=this.fb.group({district_id:["",g.required],taluka_id:["",g.required],panchayat_id:["",g.required],username:["",[g.required]],password:["",g.required]})}ngOnInit(){this.fetchDistricts()}fetchDistricts(){this.api.post("district-list-ddl",[]).subscribe(n=>{this.districtList=n.data})}fetchTalukas(n){console.log("Selected District:",n),this.api.post("taluka-list-by-district-id",{id:n}).subscribe(l=>{this.talukaList=l.data})}fetchPanchaytList(n){this.api.post("panchayat-list-by-taluka-id",{id:n}).subscribe(l=>{console.log("Panchayat List:",l.data),this.panchayatList=l.data})}onSubmit(){if(this.loginForm.valid){this.spinner.show();let{district_id:n,taluka_id:l,panchayat_id:o,username:d,password:p}=this.loginForm.value;this.api.post("sign-in",{username:d,password:p,user_type:"new_user",district_id:n,taluka_id:l,panchayat_id:o}).subscribe(u=>{this.spinner.hide(),console.log("Login Response:",u),u?.data?.token?(this.api.setToken(u?.data?.token),this.util.openDialog("Success","Logged in successfully","success"),this.router.navigate(["dashboard"])):(console.log("Invalid Credentials"),this.util.openDialog("Failed",u?.message,"error"))})}else this.util.openDialog("Failed","Form is invalid","error")}static{this.\u0275fac=function(l){return new(l||i)(f(K),f(at),f(rt),f(lt),f(T))}}static{this.\u0275cmp=b({type:i,selectors:[["app-login"]],standalone:!0,features:[x],decls:47,vars:12,consts:[[1,"login-container"],[1,"login-card"],[2,"text-align","center"],[3,"ngSubmit","formGroup"],[1,"district-selects"],["appearance","outline"],["formControlName","district_id",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","taluka_id",3,"selectionChange"],["formControlName","panchayat_id"],["matInput","","type","text","formControlName","username","placeholder","Enter your username"],["matSuffix",""],["matInput","","formControlName","password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"forgot-password"],["href","",1,"forgot-link"],[3,"value"]],template:function(l,o){if(l&1&&(e(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title")(4,"span",2),r(5,"Login"),t()()(),e(6,"mat-card-content")(7,"form",3),_("ngSubmit",function(){return o.onSubmit()}),e(8,"div",4)(9,"mat-form-field",5)(10,"mat-label"),r(11,"\u091C\u093F\u0932\u094D\u0939\u093E"),t(),e(12,"mat-select",6),_("selectionChange",function(p){return o.fetchTalukas(p.value)}),c(13,mt,2,2,"mat-option",7),t(),c(14,st,2,0,"mat-error",8),t(),e(15,"mat-form-field",5)(16,"mat-label"),r(17,"\u0924\u093E\u0932\u0941\u0915\u093E"),t(),e(18,"mat-select",9),_("selectionChange",function(p){return o.fetchPanchaytList(p.value)}),c(19,dt,2,2,"mat-option",7),t(),c(20,pt,2,0,"mat-error",8),t(),e(21,"mat-form-field",5)(22,"mat-label"),r(23,"\u092A\u0902\u091A\u093E\u092F\u0924"),t(),e(24,"mat-select",10),c(25,ct,2,2,"mat-option",7),t(),c(26,ut,2,0,"mat-error",8),t()(),e(27,"mat-form-field",5)(28,"mat-label"),r(29,"Username"),t(),y(30,"input",11),e(31,"mat-icon",12),r(32,"Username"),t(),c(33,ft,2,0,"mat-error",8),t(),e(34,"mat-form-field",5)(35,"mat-label"),r(36,"Password"),t(),y(37,"input",13),e(38,"button",14),_("click",function(){return o.hidePassword=!o.hidePassword}),e(39,"mat-icon"),r(40),t()(),c(41,gt,2,0,"mat-error",8),t(),e(42,"button",15),r(43," Login "),t(),e(44,"div",16)(45,"a",17),r(46,"Forgot Password?"),t()()()()()()),l&2){let d,p,u,v,M;a(7),m("formGroup",o.loginForm),a(6),m("ngForOf",o.districtList),a(),m("ngIf",(d=o.loginForm.get("district_id"))==null?null:d.hasError("required")),a(5),m("ngForOf",o.talukaList),a(),m("ngIf",(p=o.loginForm.get("taluka_id"))==null?null:p.hasError("required")),a(5),m("ngForOf",o.panchayatList),a(),m("ngIf",(u=o.loginForm.get("panchayat_id"))==null?null:u.hasError("required")),a(7),m("ngIf",(v=o.loginForm.get("username"))==null?null:v.hasError("required")),a(4),m("type",o.hidePassword?"password":"text"),a(3),E(o.hidePassword?"visibility_off":"visibility"),a(),m("ngIf",(M=o.loginForm.get("password"))==null?null:M.hasError("required")),a(),m("disabled",o.loginForm.invalid)}},dependencies:[F,I,L,R,N,j,U,q,tt,Z,X,J,Q,W,A,k,O,it,et,Y,V,B,G,H,$,z,w,P,ot,nt],styles:[".login-container[_ngcontent-%COMP%]{height:100vh;display:flex;justify-content:center;align-items:center;padding:16px}.login-card[_ngcontent-%COMP%]{max-width:70%;width:100%;padding:24px}mat-card-header[_ngcontent-%COMP%]{margin-bottom:24px}mat-card-title[_ngcontent-%COMP%]{font-size:24px;margin-bottom:0}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}mat-form-field[_ngcontent-%COMP%]{width:100%}button[type=submit][_ngcontent-%COMP%]{margin-top:8px;height:48px;font-size:16px}@media (max-width: 599px){.login-card[_ngcontent-%COMP%]{padding:16px}}.district-selects[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:16px}mat-form-field[_ngcontent-%COMP%]{flex:1;min-width:120px}.forgot-link[_ngcontent-%COMP%]{text-decoration:none!important}"]})}}return i})();export{Bt as a};
